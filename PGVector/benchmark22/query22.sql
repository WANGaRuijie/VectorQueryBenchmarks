/*
Query source: https://www.tigerdata.com/blog/refining-vector-search-queries-with-time-filters-in-pgvector-a-tutorial
Data source: https://huggingface.co/datasets/timescale/wikipedia-22-12-simple-embeddings/
The query embedding is extracted from the embedding of the tuple with id 19 in the dataset
*/

SELECT w.id, w.embedding <=> '[-0.20083626,-0.14190534,-0.40962303,0.16031022,-0.1782149,-0.066533685,-0.03247086,-0.34247714,0.30140796,0.60711116,-0.19750966,0.09241874,-0.27173045,0.1464311,0.15540831,0.45946446,0.5709029,0.66484874,-0.2989785,0.0778656,-0.17306782,0.82561255,-0.09239991,-0.4124312,-0.04042525,0.43519148,-0.23232616,0.6463113,0.023028148,0.13536537,-0.19359009,-0.1638615,0.07456943,0.16359465,-0.44071066,0.5369806,-0.011800315,0.049918298,0.5335061,-0.0091425115,0.07166096,0.03629815,-0.09034431,0.08435295,0.20004068,0.5982688,0.19629073,0.30236456,0.019011341,-0.009818892,-0.05871433,-0.118827224,-0.14112341,-0.2079015,-0.6658974,0.70305395,0.030888747,0.2989988,0.43515792,-0.08106454,0.41129485,-0.6533203,0.09938133,-0.43154296,0.3541848,0.24487568,0.28471902,0.20267847,0.42688626,0.6353161,0.3304077,0.36546853,0.5880238,-0.0893171,-0.17999518,-0.5935303,0.05892809,0.060780473,0.39944792,-0.21129511,0.8066007,0.01895412,-0.49937743,0.5073398,0.82511985,0.47636274,-0.04311329,0.4716253,0.17832254,0.5106778,0.33037886,0.12979886,-0.03265322,-0.33956522,-0.47024593,0.43839222,-0.19074845,0.08631314,0.33295456,-0.30694413,0.2819505,-0.25262827,-0.31843013,0.5141965,0.09869069,-0.33077586,-0.70384467,0.6819314,0.07302406,0.5054821,0.69246936,0.24155717,0.63922006,0.16413851,0.25020406,-0.41209272,0.34750935,0.017568797,-0.051813293,-0.96637964,0.0391621,0.2964022,-0.17639612,-0.06640539,-0.17507268,-0.2476507,0.7377841,-0.16173206,0.50011986,0.11140331,0.55258787,0.11216417,-0.0932124,0.8897727,-0.11995752,0.3170026,0.44671088,-0.16348073,0.45147926,-0.07032145,-1.1275035,-0.36221868,-0.07172824,0.4951294,0.105472215,0.25733975,0.046322353,0.4170632,0.109857455,0.75333804,0.32171297,0.17325148,0.00022064555,0.5680797,-0.17779985,-0.052666336,0.8705877,0.14004853,0.01759855,0.16219094,0.8124467,0.35228494,-0.7434315,-0.2621863,0.672148,-0.16445895,0.32330656,-0.0034833734,0.4148349,-0.08414305,-0.65876925,-0.15688904,0.47795188,-0.16789217,0.38789937,0.14705995,-0.18811098,-0.21103814,0.3372506,0.09589594,-0.02235409,0.3805198,-0.47597212,0.055110585,0.6746449,0.26251832,0.40212512,-0.11721415,-0.35390514,0.088215224,-0.05849443,-0.10952713,0.70194536,-0.05262465,-0.06780118,-0.027487598,-0.032150894,0.36102074,-0.34536162,-0.018573899,0.20360029,-0.25542352,0.07068898,0.6100497,0.21307041,-0.55541325,-0.32761565,0.41325018,-0.05731071,-0.052311428,0.07964702,0.08202785,0.24402271,0.2740872,0.09000522,0.008233851,-0.087340266,-0.4767999,0.46857634,-0.37231833,-0.5891335,0.410973,0.12786017,0.3175759,0.05371801,-0.39986128,-0.26091254,-0.47468707,0.073597096,0.1264747,0.73519564,0.1719463,0.043641523,0.17615172,0.18052708,0.050635356,0.4929044,0.24998946,-0.38519675,0.08751731,0.16849324,0.29978138,-0.36022228,-0.012496324,0.2710771,0.1045161,-0.14117965,0.21263026,-0.25743034,0.18567893,-0.0026254891,-0.24504387,-0.3291311,0.52963865,-0.21911143,0.18657053,0.6060458,-0.14175797,-0.06833954,-0.14868407,0.59897625,0.41596457,0.8437411,0.4657959,-0.5589333,0.5906694,0.19554637,0.47029474,0.28629082,0.4258839,0.4259233,-0.15471205,0.14890441,0.34667933,0.11996556,-0.07906633,0.1704388,0.09987588,-0.5648393,0.35515386,0.23600714,-0.44078812,-0.15106513,0.007965209,0.077447645,0.15558735,-0.20513247,0.1682423,-0.42072698,0.003720743,-0.25919175,0.5888095,0.15486766,-0.55536556,0.00029011638,0.5066262,0.25354668,0.095966406,0.46922275,0.21463867,1.0169489,-0.51598287,0.27995762,0.24122009,0.044875823,-0.21591978,-0.116683684,0.14415495,-0.017363722,0.71639293,0.49535313,-0.42539257,-0.06270052,0.65931284,0.21550018,-0.049351953,-0.119354665,-0.14183807,0.8115712,0.059642307,0.27339324,-0.19304723,-0.38998136,-0.085742496,0.5292258,-0.6296165,0.026154933,-0.31276244,0.36133394,-0.18089557,0.58183706,0.38225874,-0.3258445,-0.20078805,0.4314198,0.24223633,-0.117513485,0.43905306,-0.44666693,0.08890596,0.0013783108,-0.14292221,0.38287687,0.2682933,0.070640706,-0.027278865,-0.22725372,0.2767983,0.19304772,-0.22760141,0.12503445,-0.21020772,0.0788896,-0.23277698,0.20024025,0.084580876,0.20210572,0.3405723,0.21319608,-0.18191314,0.11134682,0.22372353,-0.0105152475,-0.055631325,0.04265303,0.4562994,0.0891854,-0.23288038,-0.071407445,-0.39004213,-0.14900798,-0.21627513,-0.24409916,0.29561824,-0.6281871,-0.35695246,-0.48511186,0.7991078,0.26866233,0.35209572,0.3762542,0.40517968,0.34713024,-0.05649506,-0.72530407,-0.5327304,-0.014307404,-0.05910863,0.14352223,-0.08107493,-0.22956543,-0.29509637,0.14095806,0.5395555,-0.066101626,0.02411877,-0.057637993,0.6775801,0.31164634,0.37303412,0.15412396,0.42578068,0.22628403,0.4981734,4.322692,0.13129161,0.23556435,-0.43819857,0.34991288,0.17795044,0.0030847723,-0.21816045,-0.049060337,-0.07012665,-0.20130976,0.4820357,-0.29331666,-0.057288848,-0.23457198,0.2789369,0.86222255,-0.118149355,0.3780958,0.33207285,-0.5961115,0.19494297,0.43026233,0.19501252,0.16681977,0.5084473,0.3124901,0.2456773,0.097796075,0.35625625,0.5698242,-0.003761985,0.1065192,0.5221258,-0.5628443,0.71257216,0.2542622,0.019711677,0.6329656,-0.015840704,-0.24279265,0.20682664,0.010548539,0.37990388,0.37569657,0.17631729,0.09303873,0.17181174,-0.13314487,0.0374656,0.20631014,-0.17581287,0.10302232,-0.6167125,0.2707231,0.49630237,0.019116662,0.114017956,-0.010528357,0.24444011,0.0852899,-0.25928712,-0.026596485,-0.10791709,-0.2824141,0.27033913,0.27718922,-0.07502313,0.1728635,-0.27820677,-0.13304399,0.3844305,-0.28636974,-0.330249,-0.094808996,-0.67521715,-0.79971594,-0.54654765,0.34915993,-0.30100244,0.50208324,-0.13874215,-0.49106002,0.39631337,-0.07480951,0.32942227,0.3841583,-0.6029319,0.30787686,0.16419275,0.59415394,-0.77505994,0.58475673,0.13159221,0.3227544,0.3735984,-0.0040147956,-3.7033381,0.21288563,0.39845094,-0.14837633,0.07658608,0.2892803,-0.119275,-0.06620067,-0.6398171,0.07719075,0.14152166,0.19857198,-0.15361191,0.31957147,-0.16650501,-0.24288414,0.18449292,0.3083331,-0.26835078,-0.07980929,0.30743518,0.33453882,-0.33572847,-0.6105624,0.15304455,-0.2560718,0.48245072,-0.4831876,0.22399157,-0.06407922,-0.24565347,0.16363858,0.7048384,-0.61668146,0.21630527,-0.07291628,0.5265553,0.49548784,-0.3142442,0.6656561,0.1209524,0.52274615,0.5382147,0.09097699,0.602033,-0.5823109,0.17317325,-0.24159239,-0.51420563,0.4618852,-0.0761673,0.5669656,-0.6281938,0.32029912,0.5870606,-0.26374602,-0.22198945,-0.7134411,0.1972075,0.30810934,0.036235183,0.10822581,0.32236022,0.22505078,-0.2822854,-0.45234153,0.12621415,0.3244944,-0.22334109,-0.1544555,0.3029469,-0.06576052,0.32270786,-0.29467228,-0.18736406,0.23354797,-0.0955298,-0.097676955,0.42620018,0.2738603,-0.35175782,0.18691432,-0.4820712,0.7615856,2.2746093,0.6204856,2.14652,-0.14804187,-0.06398968,0.54266244,-0.5800479,0.49998862,0.18937905,-0.29164264,0.42840132,0.14694583,-0.06358036,0.6751731,-0.1270256,-0.15832347,0.40313777,-0.86509454,-0.114642404,0.13911459,0.7507546,-0.072257526,-0.08733125,0.64156824,0.31062484,-0.46580365,0.6536466,-0.12792027,-0.19793646,-0.7393033,0.30908445,0.24022564,-0.18506886,0.003929606,-0.11682802,0.049526908,0.5628329,4.425213,-0.07777398,-0.2103614,0.0497423,0.05138092,0.10803979,0.46528322,0.07772345,0.012693474,0.5241111,0.92898613,0.10997426,0.46767133,-0.54807574,0.1650539,0.60987216,0.29350892,0.39727005,0.22326577,0.15124401,0.25381303,0.06688454,-0.5138561,-0.25331092,0.090944566,0.23080437,0.27624872,-0.24553393,-0.09642861,0.25522736,-0.04810153,5.215199,0.18673693,0.52208585,0.029272946,-0.37831503,0.09740768,-0.4315718,0.29365963,-0.17189206,-0.060654674,-0.108433396,0.10055056,-0.3477195,0.49938855,0.25415927,-0.19619581,-0.4077881,0.030000027,0.072822504,0.29192472,0.3229275,0.16737047,0.3066481,-0.579499,-0.49699587,-0.30740577,0.002292529,0.7402399,0.040791806,0.14652848,0.17670746,-0.24813218,0.18865912,0.31996557,-0.48386565,-0.018515708,0.26701105,0.5509344,0.09486576,-0.26782337,0.3613989,-0.16128138,-0.26883212,-0.970823,-0.011102156,0.2731168,-0.17735727,0.18282512,0.1529143,0.50825197,0.05577975,-0.08764191,0.46532816,-0.05670034,-0.28607595,0.5582963,0.49992663,-0.04308573,-0.37647802,0.0099418815,0.9548695,0.060803812,-0.1626408,0.49415326,-0.11676171,0.4240767,0.647027,0.10933713,0.08527801,0.17102814,-0.20076239,-0.061756246,0.14914356,0.5960044,-0.2571142,0.11441052,0.17329574,-0.21102212,0.2515843,-0.2662448,0.110057764,-0.4405806,-0.18022545,-0.23250122,0.6120694,0.36778954,0.5218839,0.2081038,0.40551627,0.030031655,0.32595658,-0.008432111,0.122222275,0.392415,-0.10284566,0.073963284,0.4159211,-0.06737726,-0.48550472,-0.050757788,-0.60270774,0.4602506,0.10628863,-0.53029674,0.46419343,0.02689124,0.03733413,-0.061236348,-0.17867541,0.2241761,0.5737038,0.14071988,-0.24559224,-0.07597961,0.08015539]' as dist
FROM wiki2 w
WHERE EXISTS
(
  SELECT 1
  FROM wiki2 x
  WHERE '2000-01-02' <= x.time AND x.time < '2000-01-05' AND w.id = x.id
)
ORDER BY dist