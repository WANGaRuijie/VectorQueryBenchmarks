/*
Source: https://cloud.google.com/blog/products/databases/using-pgvector-llms-and-langchain-with-google-cloud-databases
*/
WITH vector_matches AS (
                              SELECT product_id, 1 - (embedding <=> 
                                [-0.05078041926026344, -0.00454244390130043, 0.010358978062868118, -0.05531979724764824, 0.016395751386880875, -0.005800662096589804, 0.05272303521633148, -0.0312021654099226, 0.026817278936505318, 0.05664864555001259, -0.040289510041475296, -0.010581710375845432, 0.07187808305025101, 0.04976992681622505, -0.02848757430911064, 0.00613768445327878, 0.046064943075180054, -0.04636859521269798, -0.061598628759384155, -0.002899681916460395, 0.02983735129237175, -0.00220998702570796, 0.047426700592041016, -0.0664534941315651, -0.010964666493237019, -0.04535688832402229, 0.00022527379042003304, 0.02281167358160019, -0.033147506415843964, -0.005851684138178825, -0.04183457791805267, 0.05984592065215111, 0.04697122797369957, 0.038109034299850464, 0.05731286481022835, -0.0507219024002552, -0.02495795302093029, 0.00250777555629611, -0.004757128190249205, -0.10152541100978851, -0.07496165484189987, -0.04182323068380356, 0.010065355338156223, -0.05405765399336815, 0.034640565514564514, -0.02587920054793358, -0.022784259170293808, 0.02122093364596367, -0.018360449001193047, 0.013325377367436886, 0.0037242183461785316, 0.0022608484141528606, -0.012970983982086182, -0.0011310792760923505, -0.005339282099157572, -0.021149998530745506, -0.11942867189645767, 0.027857733890414238, 0.028289228677749634, 0.025189116597175598, -0.015550024807453156, -0.032505180686712265, -0.05159943923354149, -0.006829058285802603, 0.01707613468170166, -0.00757416058331728, -0.051083389669656754, -0.00040888466173782945, -0.026393037289381027, -0.05967847630381584, 0.017508575692772865, 0.05483456701040268, 0.03991643711924553, 0.017648795619606972, -0.03853846341371536, -0.031131483614444733, -0.05954793840646744, 0.0104658929631114, -0.006962052546441555, 0.02455170825123787, 0.015598277561366558, -0.02032475359737873, 0.05802705138921738, 0.031921450048685074, -0.03328409418463707, -0.02619210258126259, 0.0334680899977684, -0.05870981141924858, -0.014022181741893291, -0.005218700040131807, 0.08964557945728302, 0.01941445842385292, 0.013755452819168568, -0.032994844019412994, 0.03007115237414837, -0.06089164316654205, -0.039013609290122986, -0.020112616941332817, 0.03533937409520149, 0.07309611886739731, -0.06338116526603699, -0.057975269854068756, -0.0241681095212698, -0.03831610083580017, 0.05576636642217636, 0.061732519418001175, 0.027791516855359077, 0.03139409422874451, -0.009950155392289162, -0.0003145725349895656, 0.04196759685873985, -0.031265147030353546, -0.011599610559642315, 0.02919597737491131, -0.01184467040002346, 0.013880846090614796, 0.04335338994860649, 0.03332853689789772, -0.010058888234198093, -0.02204332873225212, -0.0262207742780447, -0.0023203527089208364, -0.06660128384828568, 0.007572001777589321, 0.01651371456682682, -0.02839507907629013, 0.04273475334048271, -0.07167063653469086, -0.053819768130779266, -0.0373101569712162, 0.018664829432964325, -0.07700428366661072, 0.0204054806381464, 0.0550156868994236, 0.010338799096643925, -0.0466473288834095, 0.08162382245063782, -0.005687398836016655, 0.0010486723622307181, 0.020022589713335037, 0.022207021713256836, -0.060291826725006104, -0.033240947872400284, 0.0089222127571702, -0.0038808099925518036, -0.019592393189668655, 0.007657367270439863, -0.040767963975667953, -0.04180468991398811, -0.03517794981598854, -0.03221147879958153, 0.03169015422463417, 0.05996963009238243, -0.01862144097685814, 0.0002936997916549444, 0.02868756465613842, 0.032913561910390854, 0.024806641042232513, 0.044925522059202194, -0.04937269166111946, -0.03118801675736904, -0.029847176745533943, 0.017431244254112244, -0.04159829765558243, -0.03147202730178833, -0.06414666026830673, -0.053186383098363876, -0.009352513588964939, -0.011282841674983501, -0.015008892863988876, -0.018760481849312782, 0.011991119012236595, -0.038292840123176575, -0.039945490658283234, 0.03650666028261185, -0.043085139244794846, -0.034286513924598694, 0.029090886935591698, 0.0318569652736187, -0.0920802503824234, 0.04675782471895218, -0.015568424947559834, 0.04143649339675903, 0.05945494771003723, -0.007080180570483208, 0.06522036343812943, -0.03242330998182297, -0.00025380912120454013, 0.0562627837061882, -0.005492387339472771, -0.054350595921278, 0.005502433516085148, 0.012897778302431107, 0.017624055966734886, 0.004927986301481724, -0.003644313896074891, 0.031754426658153534, 0.026875879615545273, 0.03921259567141533, 0.027690688148140907, 0.005806027911603451, -0.02836708538234234, -0.009797906503081322, 0.021633338183164597, -0.020579922944307327, -0.035412926226854324, -0.023834971711039543, -0.025469040498137474, 0.04008793830871582, -0.004640049301087856, 0.002995158778503537, 0.04582732543349266, -0.016728568822145462, -0.000693701789714396, 0.006253304425626993, -0.035912688821554184, -0.025297624990344048, 0.02462523989379406, 0.014326184056699276, 0.0021679848432540894, -0.006634590681642294, -0.016397081315517426, 0.041165806353092194, -0.05210742726922035, 0.019070426002144814, -0.0292949378490448, -0.044655196368694305, 0.010376669466495514, 0.022418010979890823, -0.017762277275323868, 0.025882186368107796, 0.036441951990127563, -0.023614084348082542, 0.026642659679055214, -0.0005975008243694901, 0.054337456822395325, -0.0024756495840847492, 0.008423497900366783, 0.0431675910949707, 0.05316881462931633, -0.043199315667152405, 0.002519613364711404, -0.02991369180381298, 0.01926763541996479, 0.025220144540071487, -0.02699519880115986, 0.03692510724067688, 0.03817257285118103, -0.0064620389603078365, -0.05545497313141823, -0.07003584504127502, -0.03134655952453613, 0.07322245091199875, -0.0035377033054828644, -0.020738620311021805, -0.04696478694677353, 0.06264637410640717, -0.0409480445086956, 0.0004213585634715855, -0.019885538145899773, -0.017760343849658966, 0.01677689515054226, 0.005823316052556038, -0.1001008003950119, -0.06854107230901718, -0.06827936321496964, 0.020396022126078606, 0.014260654337704182, 0.042364418506622314, 0.033513523638248444, 0.018342945724725723, -0.03555639460682869, 0.041232891380786896, -0.031258273869752884, 0.010099883191287518, -0.020419461652636528, -0.004680645186454058, -0.031598132103681564, -0.030162526294589043, -0.05418837442994118, -0.0071443528868258, -0.021102875471115112, -0.0013436805456876755, 0.02491268701851368, 0.047906696796417236, 0.005290921311825514, 0.048684608191251755, 0.00665420014411211, 0.004715915769338608, -0.017516599968075752, -0.02845684066414833, 0.02439880557358265, -0.07446108013391495, -0.05621916428208351, 0.05486465245485306, 0.028433363884687424, 0.006093920674175024, 0.03918483480811119, -0.027579326182603836, -0.016308419406414032, -0.023034045472741127, 0.04189392924308777, -0.07295345515012741, 0.033417925238609314, -0.0014624453615397215, -0.02391885593533516, 0.0686030462384224, 0.00016337668057531118, -0.008228207007050514, 0.039576657116413116, 0.027251362800598145, -0.017537491396069527, 0.004256039392203093, -0.05586004629731178, -0.031058767810463905, -0.052324771881103516, -0.05030936002731323, 0.004599649924784899, 0.049570415169000626, 0.0014087436720728874, -0.041892871260643005, 0.03330284357070923, -0.02594233676791191, -0.03778604418039322, 0.027045439928770065, -0.02644389122724533, -0.009003724902868271, 0.00843801349401474, -0.018724540248513222, 0.020953083410859108, 0.02445751614868641, 0.02711454965174198, -0.042735375463962555, -0.06213820353150368, -0.012029544450342655, 0.05686164274811745, -0.0723532885313034, 0.05729743838310242, 0.02804061397910118, -0.006067368667572737, 0.03660084307193756, 0.021010780707001686, 0.05561581626534462, 0.06106466427445412, -0.04594987630844116, -0.03644046559929848, 0.02287907339632511, 0.020680610090494156, -0.006353324744850397, -0.05834375321865082, 0.025068145245313644, 0.028285421431064606, 0.0254364013671875, -0.08201272040605545, 0.0038888745475560427, -0.01038507279008627, 0.03469886630773544, 0.014716814272105694, -0.032334428280591965, -0.015974216163158417, 0.033151037991046906, -0.019149605184793472, -0.01574363186955452, -0.018370764330029488, 0.04476458951830864, -0.00159499142318964, 0.029834343120455742, -0.01003409456461668, -0.03012671321630478, -0.023922907188534737, 0.026295285671949387, 0.0001579994277562946, -0.01732802391052246, 0.014736316166818142, 0.0241230521351099, 0.01016757171601057, 0.03963073343038559, 0.049270179122686386, -0.014656627550721169, -0.005657730624079704, 0.003059742273762822, -0.04221390560269356, -0.019839871674776077, -0.012757486663758755, 0.02069445513188839, 0.017788466066122055, -0.027805255725979805, 0.02610626630485058, -0.03330976516008377, -0.0006315625505521894, 0.0017742370255291462, 0.010807906277477741, -0.03854876756668091, 0.08481229841709137, -0.04001478850841522, 0.007123361341655254, -0.005224172025918961, 0.08639845252037048, -0.03301731497049332, 0.0010217989329248667, -0.011378070339560509, 0.00652153929695487, 0.029332902282476425, -0.0316525399684906, -0.02769363485276699, -0.009287669323384762, 0.013697429560124874, 0.026079198345541954, 0.011974222026765347, -0.034883707761764526, 0.00890757143497467, -0.03373550623655319, -0.005271280184388161, 0.0005795765318907797, -0.021849408745765686, -0.04614526033401489, 0.06663068383932114, -0.008601519279181957, -0.0053672222420573235, 0.029218891635537148, -0.08352748304605484, -0.06567271798849106, 0.03321465849876404, 0.010168841108679771, -0.012693152762949467, -0.03831598535180092, 0.04653605446219444, 0.003495546756312251, 0.024318354204297066, 0.028062693774700165, -0.021719027310609818, 0.05130099132657051, -0.04891488328576088, -0.05283675342798233, 0.06732438504695892, 0.025185981765389442, 0.028300531208515167, -0.03194968402385712, -0.006361428182572126, -0.0061590648256242275, -0.04327753558754921, -0.013454861007630825, 0.05492118373513222, 0.04375101625919342, -0.04320475086569786, 0.03405516594648361, 0.007666717749089003, 0.0565430223941803, 0.015991821885108948, -0.026853539049625397, 0.030497785657644272, -0.001988495234400034, 0.034599896520376205, -0.006574033293873072, -0.03742901608347893, 0.006438836455345154, 0.020795829594135284, -0.023409035056829453, -0.027441147714853287, 0.03315483406186104, -0.042418573051691055, -0.015203872695565224, 0.052543625235557556, 0.043556682765483856, -0.022617189213633537, -0.015058892779052258, -0.06404107064008713, -0.037139348685741425, 0.020053166896104813, 0.03700694069266319, 0.003932419698685408, -0.03305725008249283, -0.05432251840829849, -0.022523878142237663, -0.04059869050979614, 4.587888179230504e-05, 0.01459127850830555, -0.023722480982542038, -0.04422010853886604, 0.05623219534754753, 0.003611218649893999, 0.01936836913228035, -0.037416696548461914, -0.023546213284134865, 0.05791640654206276, -0.048280276358127594, 0.0467560701072216, -0.03768261894583702, 0.05250224471092224, -0.014612261205911636, -0.0027115093544125557, 0.008355698548257351, -0.003047822043299675, -0.05460762232542038, -0.05860695242881775, 0.0003710343735292554, 0.003971460275352001, -0.04880809038877487, -0.0022241841070353985, 0.022355495020747185, 0.06407933682203293, -0.03998490422964096, 0.0431857667863369, -0.008985242806375027, 0.02896352857351303, -0.053070317953825, 0.0209977850317955, 0.022256700322031975, -0.06266967952251434, -0.01563352346420288, 0.04634562134742737, -0.011938540264964104, 0.026970678940415382, -0.02184312976896763, 0.017737101763486862, 0.060679059475660324, -0.07461761683225632, 0.011645428836345673, -0.019734367728233337, -0.01795148104429245, 0.005287589505314827, -0.026482408866286278, 0.03230587765574455, -0.02659618854522705, 0.025809895247220993, -0.010437390767037868, -0.011449895799160004, 0.09989684075117111, 0.05028139054775238, 0.02119184471666813, -0.06657873094081879, 0.007486837916076183, -0.008038880303502083, 0.020981095731258392, -0.018056366592645645, -0.032785575836896896, 0.04089220240712166, -0.034979045391082764, -0.05629223957657814, 0.056780409067869186, -0.032265957444906235, -0.07179533690214157, 0.017354609444737434, -0.018485000357031822, -0.028490906581282616, -0.05952126905322075, 0.044955555349588394, 0.029782487079501152, -0.02178073115646839, 0.057340532541275024, 0.05372685194015503, -0.03763137385249138, 0.05069497227668762, 0.027379801496863365, -0.01751638390123844, 0.014441488310694695, 0.04698307067155838, -0.051497045904397964, 0.0019112474983558059, -0.026948798447847366, 0.02318655140697956, -0.003933250438421965, 0.06234214827418327, -0.05506753548979759, 0.006664111744612455, 0.03818046301603317, 0.014393938705325127, 0.022237099707126617, -0.009054213762283325, -0.05223260074853897, 0.025804918259382248, 0.025101864710450172, -0.02999071404337883, 0.04186343401670456, 0.02902955748140812, 0.02391989342868328, -0.05778765678405762, 0.02266775257885456, 0.06493104994297028, -0.10156682133674622, -0.03523546829819679, 0.026046179234981537, -0.004147335886955261, -0.0003407980257179588, -0.04930248484015465, 0.0156016256660223, -0.0010723973391577601, -0.06003261357545853, 0.006067829672247171, -0.08740627765655518, -0.011667837388813496, 0.031008116900920868, -0.02203264646232128, -0.01727948896586895, -0.0019438716117292643, -0.033248789608478546, 0.05090426653623581, -0.021688124164938927, 0.00913198757916689, -0.011701718904078007, -0.06049584969878197, 0.02712603099644184, 0.04316283389925957, 0.00684583093971014, -0.041610267013311386, -0.027734089642763138, -0.030415665358304977, -0.043722521513700485, 0.00114116829354316, -0.030385684221982956, -0.022620685398578644, -0.009598580189049244, 0.012425839900970459, -0.04763130843639374, -0.011717746034264565, 0.00427408330142498, -0.034290213137865067, 0.0085767125710845, 0.016284214332699776, -0.013409890234470367, -0.011725075542926788, 0.002019423060119152, -0.023067966103553772, -0.0007469508564099669, -0.0383661724627018, 0.005597986746579409, 0.00237874872982502, 0.026830697432160378, -0.023096736520528793, 0.005143995396792889, -0.037161074578762054, 0.060454774647951126, 0.0005631653475575149, 0.023588260635733604, 0.0042190938256680965, 0.011711543425917625, -0.002852583536878228, 0.042801372706890106, -0.002126754727214575, -0.025517461821436882, -0.027796413749456406, -0.034063342958688736, 0.0679069459438324, 0.06999583542346954, -0.043467000126838684, 0.0151963597163558, 0.02068125456571579, 0.005579797551035881, -0.02516588754951954, 0.02720140852034092, -0.017962709069252014, 0.04995211586356163, -0.03272288665175438, 0.05363958328962326, -0.01777392253279686, -0.00696107093244791, -0.03193298354744911, -0.005707578267902136, -0.004966174717992544, -0.037073083221912384, -0.04814143106341362, -0.014622638933360577, -0.022788792848587036, 0.022192945703864098, -0.0415252260863781, -0.02194022573530674, -0.06025690957903862, 0.040396735072135925, 0.06186378747224808, 0.000410178821766749, -0.009258881211280823, 0.056601498275995255, -0.04505184665322304, 0.012467174790799618, 0.01221053022891283, -0.006814947351813316, 0.009157207794487476, -0.037351351231336594, 0.009074247442185879, 0.08831918239593506, 0.07913520187139511, -0.059486500918865204, -0.020014271140098572, 0.04592043161392212, 0.054386038333177567, -0.017687639221549034, 0.06849003583192825, -0.00703313248232007, 0.019375763833522797, 0.028134962543845177, 0.029400169849395752, -0.01932585798203945, -0.006948478985577822, -0.014821695163846016, -0.06303589791059494, 0.021842053160071373, -0.0035295390989631414, 0.054038066416978836, -0.0008586192852817476, -0.009371142834424973, 0.04138169810175896, 0.012536349706351757, 0.010285369120538235, -0.008981439284980297, 0.048116013407707214, 0.006223318632692099, 0.012606414034962654, -0.012121853418648243, -0.0791098028421402, 0.001092396443709731, -0.057698722928762436, -0.017138155177235603, -0.03485671430826187, -0.018423384055495262, -0.03305512294173241, 0.040574438869953156, 0.07696262001991272, -0.013804045505821705, 0.017266804352402687, 0.01068552304059267, -0.02200266160070896, 0.00986514426767826, -0.027611413970589638, 0.02757597714662552, 0.014622447080910206, 0.030352359637618065, -0.02289358153939247, -0.02529481239616871, -0.01118881069123745, 0.08923636376857758, -0.005405962932854891, 0.031284149736166, -0.0029008574783802032, -0.004831066355109215, -0.020552873611450195, 0.037292495369911194, 0.019418828189373016, -0.032202403992414474, -0.048681821674108505, -0.04427895322442055, 0.030610132962465286, -0.013450788334012032, -0.0088500352576375, 0.0053289905190467834, 0.01041032001376152, -0.00798080675303936, 0.032413095235824585, 0.01264124270528555, 0.007352433633059263, -0.01940951496362686, -0.010641622357070446, 0.016125593334436417, 0.03280482068657875, -0.028657224029302597, 0.0415925458073616, -0.04800357297062874, -0.017746495082974434, -0.0004692634101957083, 0.008391033858060837, -0.016423407942056656, -0.030711188912391663, 0.08270376920700073, -0.0736687108874321, 0.03293173760175705, -0.06147744879126549, -0.05360077694058418, 0.02401173673570156, -0.008635401725769043]
                              ) AS similarity
                              FROM product_embeddings
                              WHERE 1 - (embedding <=> similarity) > 0.1
                              ORDER BY similarity DESC
                            )
                            SELECT product_name, list_price, description FROM products
                            WHERE product_id IN (SELECT product_id FROM vector_matches)
                            AND list_price >= 6 AND list_price <= 7